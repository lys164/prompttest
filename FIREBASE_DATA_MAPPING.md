# Firebase æ•°æ®ç»“æ„å’Œæ˜ å°„è¯´æ˜

## ğŸ“‹ æ•°æ®æ¥æº

ç³»ç»Ÿä» Firebase çš„ä¸‰ä¸ªä¸»è¦é›†åˆè¯»å–æ•°æ®ï¼š

### 1. **å‰§æœ¬æ•°æ®** - `livestory-story` é›†åˆ
- **é›†åˆåç§°**: `livestory-story`
- **æ–‡æ¡£ ID**: å‰§æœ¬åç§°ï¼ˆå¦‚ "å±é™©è¯•æ¢-å•äººå•AI"ï¼‰
- **ç”¨é€”**: å­˜å‚¨å‰§æœ¬ä¿¡æ¯
- **åŒ…å«å­—æ®µ**: å‰§æœ¬ç±»åˆ«ã€è§’è‰²æ± ã€é¢„ç½®ç­–ç•¥é€‰é¡¹ç­‰

### 2. **AI è§’è‰²æ•°æ®** - `livestory` é›†åˆ
- **é›†åˆåç§°**: `livestory`
- **æ–‡æ¡£**: æ¯ä¸ªæ–‡æ¡£ä»£è¡¨ä¸€ä¸ªç”¨æˆ·çš„ AI è§’è‰²
- **ç”¨é€”**: å­˜å‚¨ AI è§’è‰²çš„ä¸ªäººä¿¡æ¯
- **å­—æ®µ** (è‹±æ–‡å­—æ®µå):
  ```
  name              (string)  - è§’è‰²åç§°
  age               (number)  - å¹´é¾„
  nationality       (string)  - å›½ç±
  zodiac            (string)  - æ˜Ÿåº§
  mbti              (string)  - MBTI æ€§æ ¼ç±»å‹
  relation_to_user  (string)  - ä¸ç”¨æˆ·çš„å…³ç³»
  appearance        (string)  - å¤–è²Œæè¿°
  likes             (string)  - å–œå¥½/ç‰¹é•¿
  dislikes          (string)  - è®¨åŒçš„ä¸œè¥¿
  attitude_to_unknown (string) - é¢å¯¹æœªçŸ¥çš„æ€åº¦
  fear              (string)  - ææƒ§/è½¯è‚‹
  superpower        (object)  - è¶…èƒ½åŠ›ä¿¡æ¯
    â”œâ”€ name         (string)  - è¶…èƒ½åŠ›åç§°
    â””â”€ level        (number)  - è¶…èƒ½åŠ›ç­‰çº§
  birthday          (string)  - ç”Ÿæ—¥
  prototype         (string)  - åŸå‹
  ```

### 3. **ç³»ç»Ÿæç¤ºå’Œè§’è‰²è®¾å®š** - `Prompts` é›†åˆ
- **é›†åˆåç§°**: `Prompts`
- **å…³é”®æ–‡æ¡£**:
  - **å•è„šæœ¬ç±»å‹æ–‡æ¡£** (ID: `single-single-sp` ç­‰)
    - åŒ…å« `systemPrompt` å­—æ®µ
  - **livestory æ–‡æ¡£** (ID: `livestory`)
    - åŒ…å« `character` å­—æ®µ - è§’è‰²è®¾å®šæ¨¡æ¿

## ğŸ”„ æ•°æ®æ˜ å°„æµç¨‹

### ç¬¬ 1 æ­¥: ç”¨æˆ·å¼€å§‹æ¸¸æˆ
```
ç”¨æˆ·é€‰æ‹©å‰§æœ¬ + é€‰æ‹© AI è§’è‰² â†’ ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"
```

### ç¬¬ 2 æ­¥: åç«¯è·å–æ•°æ®
```
1. ä» livestory-story è¯»å–å‰§æœ¬ä¿¡æ¯
   â””â”€ ç¡®å®šè„šæœ¬ç±»å‹ (single-single-sp / single-multi-sp / multi-multi-sp)

2. ä» Prompts è¯»å– system prompt
   â””â”€ æ ¹æ®è„šæœ¬ç±»å‹ä» Prompts.{{scriptType}} è·å– systemPrompt å­—æ®µ

3. ä» Prompts.livestory è¯»å–è§’è‰²è®¾å®šæ¨¡æ¿
   â””â”€ ä» Prompts.livestory.character è·å–æ¨¡æ¿

4. ä» livestory è¯»å– AI è§’è‰²ä¿¡æ¯
   â””â”€ è·å–é€‰å®šçš„ AI è§’è‰²çš„è¯¦ç»†ä¿¡æ¯
```

### ç¬¬ 3 æ­¥: å˜é‡æ›¿æ¢
```
è§’è‰²è®¾å®šæ¨¡æ¿ï¼ˆPrompts.livestory.characterï¼‰ä¸­çš„å˜é‡
    â†“
ä½¿ç”¨ livestory ä¸­çš„ AI è§’è‰²ä¿¡æ¯æ›¿æ¢
    â†“
ç”Ÿæˆå®Œæ•´çš„è§’è‰²è®¾å®šæ–‡æœ¬
    â†“
æ›¿æ¢ systemPrompt ä¸­çš„ {{è§’è‰²è®¾å®š}} å˜é‡
    â†“
ç”Ÿæˆæœ€ç»ˆçš„ system prompt
```

## ğŸ“ å˜é‡æ˜ å°„å…³ç³»

å½“æ„å»ºè§’è‰²è®¾å®šæ—¶ï¼Œä»¥ä¸‹æ˜ å°„è§„åˆ™é€‚ç”¨ï¼š

| æ¨¡æ¿å˜é‡ | Firebase å­—æ®µ | ç±»å‹ | ç¤ºä¾‹ |
|---------|-------------|------|------|
| `{{å§“å}}` | `name` | string | "PP" |
| `{{å¹´é¾„}}` | `age` | number | 26 |
| `{{å›½ç±}}` | `nationality` | string | "æ³°å›½" |
| `{{æ˜Ÿåº§}}` | `zodiac` | string | "é‡‘ç‰›åº§" |
| `{{MBTI}}` | `mbti` | string | "ISFP" |
| `{{å’Œç”¨æˆ·çš„èº«ä»½}}` | `relation_to_user` | string | "æœ‹å‹" |
| `{{å¤–è²Œæè¿°}}` | `appearance` | string | "178cmã€ç²¾è‡´é¢å®¹..." |
| `{{å–œå¥½/ç‰¹é•¿}}` | `likes` | string | "æ—¶å°šã€å”±æ­Œã€è¡¨æ¼”" |
| `{{è®¨åŒçš„ä¸œè¥¿}}` | `dislikes` | string | "è¢«å®šä¹‰ã€ä¸‘è®¾è®¡" |
| `{{é¢å¯¹æœªçŸ¥çš„æ€åº¦}}` | `attitude_to_unknown` | string | "å¥½å¥‡ä¸”å¼€æ”¾" |
| `{{ææƒ§/è½¯è‚‹}}` | `fear` | string | "å¤±å»ç‹¬ç‰¹æ€§ï¼›æ‹…å¿ƒ..." |
| `{{è¶…èƒ½åŠ›}}` | `superpower.name` | string | "æ—¶å°šé©¾é©­" |
| `{{ç­‰çº§}}` | `superpower.level` | number | 1 |

## ğŸ”§ ä»£ç å®ç°

### å…³é”®æ–¹æ³•ä½ç½®

**æ–‡ä»¶**: `backend/src/services/scriptService.ts`

#### 1. `getSystemPromptTemplate(scriptType)` - ç¬¬ 52-75 è¡Œ
```
ä» Prompts é›†åˆè¯»å– system prompt
```

#### 2. `getCharacterTemplate(scriptType)` - ç¬¬ 83-103 è¡Œ
```
ä» Prompts.livestory è¯»å–è§’è‰²è®¾å®šæ¨¡æ¿
```

#### 3. `buildCharacterDescription()` - ç¬¬ 130-166 è¡Œ
```
ä½¿ç”¨ livestory ä¸­çš„ AI è§’è‰²ä¿¡æ¯æ›¿æ¢æ¨¡æ¿å˜é‡
```

## âœ… Firebase ç»“æ„æ£€æŸ¥æ¸…å•

ç¡®ä¿ Firebase ä¸­å·²é…ç½®ä»¥ä¸‹å†…å®¹ï¼š

- [ ] `livestory-story` é›†åˆå­˜åœ¨ï¼ŒåŒ…å«å‰§æœ¬æ–‡æ¡£
- [ ] `livestory` é›†åˆå­˜åœ¨ï¼ŒåŒ…å« AI è§’è‰²æ–‡æ¡£
- [ ] `Prompts` é›†åˆå­˜åœ¨
- [ ] `Prompts` ä¸­æœ‰è„šæœ¬ç±»å‹æ–‡æ¡£ (`single-single-sp` ç­‰)
  - [ ] æ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ `systemPrompt` å­—æ®µ
- [ ] `Prompts.livestory` æ–‡æ¡£å­˜åœ¨
  - [ ] åŒ…å« `character` å­—æ®µï¼ˆè§’è‰²è®¾å®šæ¨¡æ¿ï¼‰
- [ ] `livestory` é›†åˆä¸­çš„ AI è§’è‰²æ–‡æ¡£
  - [ ] åŒ…å«æ‰€æœ‰å¿…éœ€çš„è‹±æ–‡å­—æ®µ (name, age, nationality ç­‰)
  - [ ] superpower æ˜¯å¯¹è±¡ï¼ŒåŒ…å« name å’Œ level å±æ€§

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜: 500 é”™è¯¯æˆ–è§’è‰²è®¾å®šä¸æ˜¾ç¤º

**å¯èƒ½åŸå› **:
1. `Prompts.livestory` æ–‡æ¡£ä¸å­˜åœ¨
2. `Prompts.livestory.character` å­—æ®µä¸ºç©º
3. `livestory` é›†åˆä¸­çš„ AI è§’è‰²å­—æ®µåä¸æ˜¯è‹±æ–‡
4. Firestore è§„åˆ™ä¸å…è®¸è¯»å–

**è§£å†³æ­¥éª¤**:
1. æ£€æŸ¥ Firebase Console ä¸­çš„æ•°æ®ç»“æ„
2. éªŒè¯ `Prompts.livestory` æ–‡æ¡£ç¡®å®å­˜åœ¨
3. ç¡®ä¿ `character` å­—æ®µåŒ…å«å®Œæ•´çš„æ¨¡æ¿
4. æ£€æŸ¥ Firestore è§„åˆ™å…è®¸åç«¯æœåŠ¡è´¦æˆ·è¯»å–è¿™äº›é›†åˆ

## ğŸ“Š æ•°æ®æµå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ç‚¹å‡»å¼€å§‹æ¸¸æˆ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯æŸ¥è¯¢ livestory-story        â”‚
â”‚ è·å–: å‰§æœ¬ä¿¡æ¯ã€è§’è‰²ç±»åˆ«        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ ¹æ®è„šæœ¬ç±»å‹æŸ¥è¯¢ Prompts        â”‚
â”‚ è·å–: systemPrompt              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŸ¥è¯¢ Prompts.livestory          â”‚
â”‚ è·å–: character æ¨¡æ¿            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŸ¥è¯¢ livestory ä¸­çš„ AI è§’è‰²     â”‚
â”‚ è·å–: è§’è‰²çš„è¯¦ç»†ä¿¡æ¯            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨ AI è§’è‰²ä¿¡æ¯æ›¿æ¢æ¨¡æ¿å˜é‡      â”‚
â”‚ ç”Ÿæˆ: è§’è‰²è®¾å®šæ–‡æœ¬              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ›¿æ¢ systemPrompt ä¸­çš„          â”‚
â”‚ {{è§’è‰²è®¾å®š}} å˜é‡               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‘é€å®Œæ•´ system prompt ç»™ AI    â”‚
â”‚ å¼€å§‹ç”Ÿæˆæ•…äº‹                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ æ€»ç»“

- âœ… å‰§æœ¬æ•°æ®æ¥è‡ª `livestory-story` é›†åˆ
- âœ… AI è§’è‰²æ•°æ®æ¥è‡ª `livestory` é›†åˆï¼ˆè‹±æ–‡å­—æ®µåï¼‰
- âœ… System prompt æ¥è‡ª `Prompts` é›†åˆ
- âœ… è§’è‰²è®¾å®šæ¨¡æ¿æ¥è‡ª `Prompts.livestory.character`
- âœ… å˜é‡æ›¿æ¢ä½¿ç”¨ livestory ä¸­çš„å®é™… AI è§’è‰²ä¿¡æ¯

