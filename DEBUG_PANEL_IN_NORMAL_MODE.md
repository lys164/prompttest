# 正常游玩模式中的调试面板

## ✅ 现在"正常游玩"模式中已包含调试面板

好消息！调试面板已经被集成到"正常游玩"（Normal Mode）中，用户可以在游玩时随时打开调试面板进行实时调试。

## 🎮 使用场景

### 正常游玩模式（Normal Mode）
- URL: `/game/[sessionId]` 或 `/game/[sessionId]?mode=normal`
- **新增**: 右下角 "🔧 打开调试" 按钮
- **功能**: 可以在游玩过程中实时修改系统提示和选择 AI 模型

### 调试模式（Debug Mode）
- URL: `/game/[sessionId]?mode=debug`
- **功能**: 独立的调试界面，用于测试不同的提示和参数
- **原有功能**: 仍然保持不变

### 对比模式（Compare Mode）
- URL: `/game/[sessionId]?mode=compare`
- **功能**: 对比不同模型的输出
- **原有功能**: 仍然保持不变

## 🎯 调试面板在正常游玩模式中的位置和使用方式

1. **位置**: 游戏页面右下角
2. **按钮**: "🔧 打开调试" 
3. **打开方式**: 点击按钮即可打开右侧调试面板

## 📋 调试面板功能

在"正常游玩"模式中，用户可以：

1. **选择 AI 模型** (📌 选择模型)
   - GPT-4 Turbo（默认）
   - GPT-4
   - GPT-3.5 Turbo
   - Claude 3 Opus
   - Claude 3 Sonnet
   - Llama 2 70B

2. **编辑系统提示** (📝 系统提示)
   - 查看 Firebase 中的默认系统提示
   - 修改系统提示
   - 状态指示：已修改/使用默认

3. **操作按钮**
   - 🔄 **重置**: 恢复到 Firebase 默认值
   - 📋 **复制**: 复制系统提示到剪贴板

4. **状态信息** (📊 当前状态)
   - 当前模型
   - 系统提示状态
   - 游戏状态

## 🚀 使用流程

### 第一步：进入游戏
1. 选择剧本
2. 选择 AI 角色
3. 点击"开始游戏"
4. 进入"正常游玩"模式

### 第二步：打开调试面板
1. 在游戏页面右下角找到 "🔧 打开调试" 按钮
2. 点击打开调试面板（从右侧滑入）

### 第三步：修改配置
1. 在下拉菜单中选择不同的 AI 模型
2. 在文本框中修改系统提示
3. 点击 "🔄 重置" 可回到默认值

### 第四步：查看效果
1. 在游戏中进行任何操作（选择选项）
2. 修改后的系统提示和选择的模型会立即用于下一次 AI 请求
3. 观察 AI 的不同输出

## 💡 最佳实践

### 测试不同模型
- 快速切换模型来测试哪个模型产生最佳效果
- 观察不同模型在相同系统提示下的输出差异

### 优化系统提示
- 在正常游玩中实时编辑系统提示
- 立即看到修改对 AI 输出的影响
- 无需重启游戏或服务器

### 对比分析
- 记下有效的系统提示
- 使用 "📋 复制" 功能保存到剪贴板
- 在不同模型中测试相同的提示

## 🔧 技术实现

### 前端实现
- **组件**: `frontend/components/game/GamePlayMode.tsx`
- **功能**:
  - 调试面板开关按钮（右下角固定位置）
  - 模型选择下拉菜单
  - 系统提示文本编辑框
  - 操作按钮（重置、复制）
  - 实时状态显示

### 后端支持
- **API**: `POST /api/game/sessions/:sessionId/choose`
- **新参数**:
  - `systemPromptOverride`: 自定义系统提示
  - `selectedModel`: 选择的 AI 模型
- **逻辑**:
  - 优先使用自定义系统提示
  - 将选择的模型传给 AI 服务
  - 在下一次请求中立即应用

## ✨ 核心优势

✅ **无处不在** - 在正常游玩中也能随时调试
✅ **实时生效** - 修改立即应用，无需重启
✅ **完全可选** - 调试面板可随时关闭
✅ **性能无影响** - 调试面板默认隐藏，不影响游戏体验
✅ **向后兼容** - 不影响原有的游戏流程

## 📱 UI 设计特点

- **位置**: 固定在右下角，不遮挡游戏内容
- **动画**: 从右侧滑入/滑出，动作流畅
- **样式**: 深色主题，与游戏UI风格一致
- **响应性**: 完全响应式设计

## 🎯 总结

现在用户在"正常游玩"模式中可以：
1. ✅ 随时打开调试面板
2. ✅ 实时修改系统提示
3. ✅ 快速切换 AI 模型
4. ✅ 观察修改效果
5. ✅ 优化游戏体验

所有功能都已集成到 `GamePlayMode` 组件中，无需额外配置即可使用！

