# ğŸ”¥ Firebase æ··åˆæ–¹æ¡ˆé…ç½®

## âœ… å·²å®Œæˆçš„é…ç½®

### 1ï¸âƒ£ æ··åˆé›†æˆæ–¹æ¡ˆå®ç°

**ScriptService** ç°åœ¨é‡‡ç”¨æ··åˆæ–¹æ¡ˆï¼š
- âœ… **ä¼˜å…ˆå°è¯•ä» Firebase è¯»å–** (`livestory-story` é›†åˆ)
- âœ… **å¦‚æœ Firebase æ— æ•°æ®æˆ–å‡ºé”™ï¼Œè‡ªåŠ¨ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®**
- âœ… **æ”¯æŒæŒ‰ç±»åˆ«ç­›é€‰**
- âœ… **åŒ…å«å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—**

```typescript
// æµç¨‹ï¼š
1. å°è¯•ä» Firebase è¯»å– â†’ æˆåŠŸ â†’ è¿”å› Firebase æ•°æ®
2. å°è¯•ä» Firebase è¯»å– â†’ å¤±è´¥æˆ–æ— æ•°æ® â†’ ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
```

### 2ï¸âƒ£ UserService æ··åˆé›†æˆ

**UserService** ç°åœ¨é‡‡ç”¨æ··åˆæ–¹æ¡ˆï¼š
- âœ… **ä¼˜å…ˆä» Firebase çš„ `users/{userId}/aiCharacters` é›†åˆè¯»å–**
- âœ… **å¦‚æœæ— æ•°æ®ï¼Œè‡ªåŠ¨ä½¿ç”¨é»˜è®¤çš„3ä¸ªæ¼”ç¤ºAIè§’è‰²**
- âœ… **è‡ªåŠ¨ä¸ºæ–°ç”¨æˆ·ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®**
- âœ… **åŒ…å«æ¨èç³»ç»Ÿ**

### 3ï¸âƒ£ æ•°æ®å­—æ®µå®Œæ•´åŒ–

ä¸ºäº†å…¼å®¹å‰ç«¯ï¼Œåç«¯ç°åœ¨åŒæ—¶è¿”å›ï¼š
- ä¸­æ–‡å­—æ®µï¼š`å‰§æœ¬ç±»åˆ«`ã€`å‰§æœ¬ç®€ä»‹`ã€`æ•…äº‹å†…å®¹` ç­‰
- è‹±æ–‡åˆ«åï¼š`title`ã€`description` ç”¨äºå‰ç«¯æ˜¾ç¤º

## ğŸ“ Firebase é›†åˆç»“æ„

### livestory-story é›†åˆ
```
collection: 'livestory-story'
documents: [
  {
    id: 'script-001',
    å‰§æœ¬ç±»åˆ«: 'ã€å•äººã€‘ã€å¤šAIã€‘',
    å“ç±»æ ‡ç­¾: ['å†’é™©', 'æ‚¬ç–‘'],
    å‚ä¸AIæ•°: 2,
    å‰§æœ¬ç®€ä»‹: '...',
    å‰§æœ¬å°é¢: '...',
    æ•…äº‹å†…å®¹: '...',
    è§’è‰²æ± : [...],
    è§’è‰²è¯¦ç»†è®¾å®š: [...]
  }
]
```

### users é›†åˆ - å­é›†åˆ aiCharacters
```
collection: 'users/{userId}/aiCharacters'
documents: [
  {
    id: 'ai-char-001',
    å§“å: 'å‹‡æ•¢çš„æ¢é™©å®¶',
    å’Œç”¨æˆ·çš„èº«ä»½: 'è™šæ‹ŸåŠ©æ‰‹',
    MBTI: 'ENFP',
    å¹´é¾„: 25,
    // ... å…¶ä»–15ä¸ªå­—æ®µ
  }
]
```

## ğŸ” æµ‹è¯•æ··åˆæ–¹æ¡ˆ

### æŸ¥çœ‹åç«¯æ—¥å¿—
```bash
tail -f /tmp/backend.log
```

ä½ ä¼šçœ‹åˆ°ä»¥ä¸‹å…¶ä¸­ä¸€æ¡æ—¥å¿—ï¼š
```
ğŸ“– ä» Firebase è¯»å– X ä¸ªå‰§æœ¬        # Firebase æœ‰æ•°æ®
âš ï¸  Firebase ä¸­æ²¡æœ‰å‰§æœ¬æ•°æ®ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®  # Firebase æ— æ•°æ®
âš ï¸  Firebase è¯»å–å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®   # Firebase å‡ºé”™
```

### æµ‹è¯• API
```bash
# è·å–å‰§æœ¬
curl http://localhost:3001/api/scripts | jq '.data[] | {id, title, å‰§æœ¬ç±»åˆ«}'

# æŒ‰ç±»åˆ«è·å–å‰§æœ¬
curl "http://localhost:3001/api/scripts?category=ã€å•äººã€‘ã€å¤šAIã€‘" | jq '.data'

# è·å–ç”¨æˆ·AIè§’è‰²
curl http://localhost:3001/api/game/user-characters/test-user | jq '.data[] | {id, å§“å, MBTI}'
```

## ğŸ¯ ä½•æ—¶ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®

### å¼€å‘é˜¶æ®µ
- åç«¯å¼€å‘æµ‹è¯• âœ… ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
- å‰ç«¯å¼€å‘æµ‹è¯• âœ… ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
- å¿«é€ŸåŸå‹åˆ¶ä½œ âœ… ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®

### Firebase é›†æˆå
- Firebase æœ‰çœŸå®æ•°æ® âœ… è‡ªåŠ¨åˆ‡æ¢åˆ° Firebase æ•°æ®
- Firebase æ— æ•°æ® âœ… è‡ªåŠ¨å›é€€åˆ°æ¨¡æ‹Ÿæ•°æ®
- Firebase è¿æ¥é”™è¯¯ âœ… è‡ªåŠ¨å›é€€åˆ°æ¨¡æ‹Ÿæ•°æ®

## ğŸ“Š å½“å‰çŠ¶æ€

| åŠŸèƒ½ | çŠ¶æ€ | å¤‡æ³¨ |
|------|------|------|
| åç«¯æ··åˆé›†æˆ | âœ… å®Œæˆ | ScriptService & UserService |
| å‰ç«¯æ•°æ®å±•ç¤º | âœ… å®Œæˆ | æ”¯æŒä¸­æ–‡å­—æ®µ |
| æ¨¡æ‹Ÿæ•°æ®å¤‡ç”¨ | âœ… å®Œæˆ | 2ä¸ªå‰§æœ¬ + 3ä¸ªAIè§’è‰² |
| Firebase é›†æˆå‡†å¤‡ | âœ… å®Œæˆ | å¯éšæ—¶è¯»å– Firebase |
| é”™è¯¯å¤„ç† | âœ… å®Œæˆ | è‡ªåŠ¨å›é€€æœºåˆ¶ |
| æ—¥å¿—è®°å½• | âœ… å®Œæˆ | æ–¹ä¾¿è°ƒè¯• |

## ğŸš€ å¯åŠ¨ç³»ç»Ÿ

### åç«¯
```bash
cd /tmp/interactive-drama-game/backend
npm start
```

### å‰ç«¯
```bash
cd /tmp/interactive-drama-game/frontend
npm run dev
```

### è®¿é—®
```
http://localhost:3000
```

## ğŸ” Firebase é…ç½®

å¦‚æœéœ€è¦çœŸæ­£è¿æ¥ Firebaseï¼Œç¡®ä¿ï¼š
1. âœ… `backend/src/config/firebase.ts` ä¸­çš„é…ç½®æ­£ç¡®
2. âœ… Firebase é¡¹ç›®æœ‰ `livestory-story` é›†åˆå’Œ `users` é›†åˆ
3. âœ… æ•°æ®ç»“æ„ä¸ä¸Šé¢æè¿°çš„ä¸€è‡´

## ğŸ“ åç«¯æ—¥å¿—ç¤ºä¾‹

### æˆåŠŸä» Firebase è¯»å–
```
ğŸ“– ä» Firebase è¯»å– 2 ä¸ªå‰§æœ¬
ğŸ“– ä» Firebase æŒ‰ç±»åˆ« ã€å•äººã€‘ã€å¤šAIã€‘ è¯»å– 1 ä¸ªå‰§æœ¬
ğŸ¤– ä» Firebase è¯»å–ç”¨æˆ· user-123 çš„ 3 ä¸ªAIè§’è‰²
```

### å›é€€åˆ°æ¨¡æ‹Ÿæ•°æ®
```
âš ï¸  Firebase ä¸­æ²¡æœ‰å‰§æœ¬æ•°æ®ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
âš ï¸  Firebase æŒ‰ç±»åˆ«è¯»å–å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
âš ï¸  Firebase ä¸­æ²¡æœ‰ç”¨æˆ· user-123 çš„AIè§’è‰²æ•°æ®ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
```

### é”™è¯¯æƒ…å†µ
```
âš ï¸  Firebase è¯»å–å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®: [error details]
âš ï¸  Firebase è¯»å–å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®: [error details]
```

## âœ¨ æ··åˆæ–¹æ¡ˆä¼˜åŠ¿

1. **å¼€å‘å‹å¥½** - ä¸éœ€è¦ Firebase å°±èƒ½å¼€å‘
2. **ç”Ÿäº§å°±ç»ª** - è¿æ¥ Firebase åè‡ªåŠ¨ä½¿ç”¨çœŸå®æ•°æ®
3. **å®¹é”™æœºåˆ¶** - Firebase å‡ºé—®é¢˜æ—¶è‡ªåŠ¨å›é€€
4. **é›¶åœæœºå‡çº§** - éšæ—¶å¯ä»¥ä»æ¨¡æ‹Ÿæ•°æ®åˆ‡æ¢åˆ°çœŸå®æ•°æ®
5. **æ–¹ä¾¿æµ‹è¯•** - å¯ä»¥åŒæ—¶æµ‹è¯•ä¸¤å¥—æ•°æ®æº

## ğŸ¬ åç»­æ­¥éª¤

1. **æœ¬åœ°æµ‹è¯•** - ç°åœ¨ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®å°±èƒ½å®Œæ•´ç©æ¸¸æˆ
2. **Firebase é…ç½®** - å½“å‡†å¤‡å¥½æ—¶ï¼Œåªéœ€ç¡®ä¿é›†åˆå’Œå­—æ®µååŒ¹é…
3. **æ•°æ®è¿ç§»** - å°†çœŸå®å‰§æœ¬æ•°æ®å¯¼å…¥ Firebase
4. **ç”Ÿäº§éƒ¨ç½²** - ç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨ Firebase æ•°æ®

---

ç³»ç»Ÿç°åœ¨å·²ç»å¯ä»¥ï¼š
- âœ… æ˜¾ç¤ºå‰§æœ¬å¤§å…ä¸­çš„2ä¸ªç¤ºä¾‹å‰§æœ¬
- âœ… æ”¯æŒå‰§æœ¬åˆ†ç±»ç­›é€‰
- âœ… å®Œæ•´çš„å¤šè§’è‰²æ•…äº‹ç”Ÿæˆ
- âœ… å‡†å¤‡å¥½é›†æˆ Firebase

